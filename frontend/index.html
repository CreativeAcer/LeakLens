<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LeakLens ‚Äî Credential Exposure Scanner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="icon" type="image/svg+xml" href="Assets/leaklens-logo.svg" />
  <link rel="stylesheet" href="Assets/styles.css" />
</head>
<body>

<div class="shell">

  <!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ -->
  <header>
    <div class="logo">
      <div class="logo-mark">
        <img src="Assets/leaklens-logo.svg" alt="LL" style="height:42px;width:42px;border-radius:6px;" />
      </div>
      <div class="logo-text">
        <h1>LeakLens</h1>
        <span>Credential Exposure Scanner</span>
      </div>
    </div>
    <div class="header-status">
      <div class="status-dot" id="statusDot"></div>
      <span id="statusText">Idle</span>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ -->
  <aside>

    <!-- Scan config -->
    <div class="panel">
      <div class="panel-header">‚¨° Scan Configuration</div>
      <div class="panel-body">
        <label>File Share Path</label>
        <input type="text" id="scanPath" placeholder="\\server\share or C:\path" oninput="onPathInput()" />

        <label>Max File Size (MB)</label>
        <input type="number" id="maxFileSizeMB" value="10" min="1" max="500" />

        <label>Worker Threads</label>
        <input type="number" id="workerCount" value="8" min="1" max="32" title="Parallel file analysis threads (1‚Äì32). Default 8 for SMB, increase to 16 for large local scans." />

        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
          <input type="checkbox" id="resumeScan" style="width:auto;margin:0;" title="Resume from the last checkpoint if the previous scan was interrupted." />
          Resume interrupted scan
        </label>

        <button class="btn btn-primary" id="startBtn" onclick="startScan()">
          <span>‚ñ∂</span> Start Scan
        </button>
        <button class="btn btn-danger" id="stopBtn" onclick="stopScan()" disabled>
          <span>‚ñ†</span> Stop Scan
        </button>
      </div>
    </div>

    <!-- SMB Credentials (revealed on UNC path) -->
    <div class="panel" id="smbPanel" style="display:none">
      <div class="panel-header">‚¨° SMB Credentials</div>
      <div class="panel-body">
        <label>Username</label>
        <input type="text" id="smbUsername" placeholder="DOMAIN\user  (blank = guest)" />
        <label>Password</label>
        <input type="password" id="smbPassword" placeholder="(leave blank for guest)" />
        <label>Domain</label>
        <input type="text" id="smbDomain" placeholder="optional" />
        <button class="btn btn-ghost" id="discoverBtn" onclick="discoverShares()">
          ‚¨° Discover Shares
        </button>
        <div id="sharesList"></div>
      </div>
    </div>

    <!-- Stats -->
    <div class="panel">
      <div class="panel-header">‚¨° Statistics</div>
      <div class="panel-body">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="value" id="statScanned">0</div>
            <div class="label">Scanned</div>
          </div>
          <div class="stat-card">
            <div class="value" id="statFindings">0</div>
            <div class="label">Findings</div>
          </div>
        </div>
        <div class="progress-wrap" style="margin-top:12px;">
          <div class="progress-track">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- Risk breakdown -->
    <div class="panel">
      <div class="panel-header">‚¨° Risk Breakdown</div>
      <div class="panel-body risk-bar">
        <div class="risk-row">
          <span class="risk-label HIGH">HIGH</span>
          <div class="risk-track"><div class="risk-fill HIGH" id="riskFillHigh" style="width:0%"></div></div>
          <span class="risk-count" id="riskCountHigh">0</span>
        </div>
        <div class="risk-row">
          <span class="risk-label MEDIUM">MED</span>
          <div class="risk-track"><div class="risk-fill MEDIUM" id="riskFillMed" style="width:0%"></div></div>
          <span class="risk-count" id="riskCountMed">0</span>
        </div>
        <div class="risk-row">
          <span class="risk-label LOW">LOW</span>
          <div class="risk-track"><div class="risk-fill LOW" id="riskFillLow" style="width:0%"></div></div>
          <span class="risk-count" id="riskCountLow">0</span>
        </div>
      </div>
    </div>

  </aside>

  <!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
  <main>

    <!-- Tabs -->
    <div class="tabs">
      <div class="tab active" data-tab="findings" onclick="switchTab('findings')">
        Findings <span class="tab-badge" id="findingsBadge" style="display:none">0</span>
      </div>
      <div class="tab" data-tab="log" onclick="switchTab('log')">Live Log</div>
      <div class="tab" data-tab="reports" onclick="switchTab('reports')">Reports</div>
    </div>

    <!-- Findings tab -->
    <div class="tab-panel active" id="tab-findings">
      <div class="findings-wrap">
        <div class="findings-toolbar">
          <button class="filter-btn active-ALL" onclick="setFilter('ALL')" id="fAll">All</button>
          <button class="filter-btn" onclick="setFilter('HIGH')" id="fHigh">High</button>
          <button class="filter-btn" onclick="setFilter('MEDIUM')" id="fMed">Medium</button>
          <button class="filter-btn" onclick="setFilter('LOW')" id="fLow">Low</button>
          <input type="text" class="search-input" placeholder="Search filename or path‚Ä¶" oninput="renderTable()" id="searchInput" />
        </div>

        <div class="empty-state" id="emptyState">
          <div class="icon">üîç</div>
          <p>Configure a path and start a scan to see findings here.</p>
        </div>

        <table class="findings-table" id="findingsTable" style="display:none">
          <thead>
            <tr>
              <th style="width:90px">Risk</th>
              <th>Filename</th>
              <th>Path</th>
              <th>Size</th>
              <th>Findings</th>
              <th>Modified</th>
            </tr>
          </thead>
          <tbody id="vsPadTop"><tr><td colspan="6" id="vsTopSpacer" style="height:0;padding:0;border:none;"></td></tr></tbody>
          <tbody id="tableBody"></tbody>
          <tbody id="vsPadBot"><tr><td colspan="6" id="vsBotSpacer" style="height:0;padding:0;border:none;"></td></tr></tbody>
        </table>
      </div>
    </div>

    <!-- Log tab -->
    <div class="tab-panel" id="tab-log">
      <div class="log-wrap" id="logWrap"></div>
    </div>

    <!-- Reports tab -->
    <div class="tab-panel" id="tab-reports">
      <div class="reports-toolbar">
        <button class="btn-sm" onclick="loadReports()">‚Üª Refresh</button>
      </div>
      <div class="reports-list" id="reportsContent">
        <div class="empty-state">
          <div class="icon">üìã</div>
          <p>No reports yet. Run a scan to generate a report.</p>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- ‚îÄ‚îÄ DETAIL DRAWER ‚îÄ‚îÄ -->
<div class="drawer-overlay" id="drawerOverlay" onclick="closeDrawer()"></div>
<div class="drawer" id="drawer">
  <button class="drawer-close" onclick="closeDrawer()">‚úï Close</button>
  <div id="drawerContent"></div>
</div>

<script src="Assets/app.js"></script>
</body>
</html>
